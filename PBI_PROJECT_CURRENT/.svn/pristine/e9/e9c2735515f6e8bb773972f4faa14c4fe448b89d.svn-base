{
  "name": "FYP - AD",
  "expression": [
    "",
    "VAR AD = IF(HASONEVALUE(AD_List[AD_Code]),values(AD_List[AD_Code]),blank())",
    "VAR L1 =",
    "CALCULATE(",
    "    [Cal_FYPinclTopup]",
    "    ,FactADHistory[L1NP] = AD",
    ")",
    "VAR L2 =",
    "CALCULATE(",
    "    [Cal_FYPinclTopup]",
    "    ,FactADHistory[L2NP] = AD",
    ")",
    "VAR L3 =",
    "CALCULATE(",
    "    [Cal_FYPinclTopup]",
    "    ,FactADHistory[L3NP] = AD",
    ")",
    "VAR L4 =",
    "CALCULATE(",
    "    [Cal_FYPinclTopup]",
    "    ,FactADHistory[L4NP] = AD",
    ")",
    "VAR L5 =",
    "CALCULATE(",
    "    [Cal_FYPinclTopup]",
    "    ,FactADHistory[L5NP] = AD",
    ")",
    "",
    "RETURN L1+L2+L3+L4+L5"
  ],
  "formatString": "G"
}