{
  "name": "ADSelected",
  "expression": [
    "VAR L1Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[L1Name] ),",
    "        TOPN ( 1, VALUES ( FactADHistory[L1new] ) ),",
    "        BLANK ()",
    "    )",
    "VAR L2Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[L2Name] ),",
    "        TOPN ( 1, VALUES ( FactADHistory[L2new] ) ),",
    "        BLANK ()",
    "    )",
    "VAR L3Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[L3Name] ),",
    "        TOPN ( 1, VALUES ( FactADHistory[L3new] ) ),",
    "        BLANK ()",
    "    )",
    "VAR L4Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[L4Name] ),",
    "        TOPN ( 1, VALUES ( FactADHistory[L4new] ) ),",
    "        BLANK ()",
    "    )",
    "VAR L5Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[L5Name] ),",
    "        TOPN ( 1, VALUES ( FactADHistory[L5new] ) ),",
    "        BLANK ()",
    "    )",
    "VAR AD =",
    "    SWITCH (",
    "        TRUE (),",
    "        L5Select <> BLANK (), L5Select,",
    "        L4Select <> BLANK (), L4Select,",
    "        L3Select <> BLANK (), L3Select,",
    "        L2Select <> BLANK (), L2Select,",
    "        L1Select <> BLANK (), L1Select",
    "    )",
    "RETURN",
    "    AD"
  ],
  "formatString": "G"
}