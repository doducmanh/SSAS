{
  "name": "ADCodeSelected",
  "expression": [
    "VAR AD_Code_Lookup =",
    "    IF ( [ADSelected] <> BLANK (), [ADSelected], BLANK () )",
    "VAR L1Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[TD] ),",
    "        VALUES ( FactADHistory[TD] ),",
    "        BLANK ()",
    "    )",
    "VAR L2Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[SRD] ),",
    "        VALUES ( FactADHistory[SRD] ),",
    "        BLANK ()",
    "    )",
    "VAR L3Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[RD] ),",
    "        VALUES ( FactADHistory[RD] ),",
    "        BLANK ()",
    "    )",
    "VAR L4Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[SZD] ),",
    "        VALUES ( FactADHistory[SZD] ),",
    "        BLANK ()",
    "    )",
    "VAR L5Select =",
    "    IF (",
    "        HASONEFILTER ( FactADHistory[AD_Code] ),",
    "        VALUES ( FactADHistory[AD_Code] ),",
    "        BLANK ()",
    "    )",
    "VAR AD =",
    "    SWITCH (",
    "        TRUE (),",
    "        AD_Code_Lookup <> BLANK (), AD_Code_Lookup,",
    "        L5Select <> BLANK (), L5Select,",
    "        L4Select <> BLANK (), L4Select,",
    "        L3Select <> BLANK (), L3Select,",
    "        L2Select <> BLANK (), L2Select,",
    "        L1Select <> BLANK (), L1Select",
    "    ) --VAR TrimAD = IF(RIGHT(AD,1) = \"P\", LEFT(AD,5),AD)",
    "RETURN",
    "    AD"
  ],
  "formatString": "G"
}